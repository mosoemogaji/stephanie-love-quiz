
<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>For Stephanie ‚Äî A Deeper Love Quiz from Mosope</title>
<style>
  :root{ --bg:#071026; --card:#091427; --accent:#ff7b95; --text:#f6f7fb; --muted:rgba(246,247,251,0.72) }
  html,body{height:100%;margin:0;font-family:Inter,ui-sans-serif,system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue",Arial;background:radial-gradient(1200px 600px at 10% 10%, rgba(255,107,129,0.06), transparent), linear-gradient(180deg,#021024,#071026); color:var(--text)}
  body{display:block;align-items:center;justify-content:center;padding:20px;box-sizing:border-box;}
  .card{width:min(960px,98%); background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01)); border-radius:18px; padding:28px; box-shadow:0 14px 50px rgba(2,6,23,0.7); position:relative; overflow:auto;}
  header{display:flex;gap:14px;align-items:center}
  h1{margin:0;font-size:26px}
  .lead{margin-top:6px;color:var(--muted)}
  .intro{margin-top:12px;padding:12px 14px;border-radius:12px;background:rgba(255,255,255,0.012);}
  .questions{margin-top:18px; display:grid; grid-template-columns: 1fr; gap:12px}
  .q{padding:12px;border-radius:12px;background:linear-gradient(180deg,rgba(255,255,255,0.01),rgba(255,255,255,0.005)); opacity:0; transform:translateY(12px); transition:all 420ms cubic-bezier(.2,.9,.3,1);}
  .q.visible{opacity:1; transform:translateY(0);}
  label{display:block;font-weight:700;margin-bottom:8px}
  textarea,input[type="text"]{width:100%;padding:10px;border-radius:10px;border:1px solid rgba(255,255,255,0.06);background:transparent;color:var(--text);box-sizing:border-box}
  textarea{min-height:80px; resize:vertical}
  .controls{display:flex;gap:10px;margin-top:16px;flex-wrap:wrap}
  .btn{padding:10px 14px;border-radius:10px;border:1px solid rgba(255,255,255,0.08);background:transparent;color:var(--text);cursor:pointer}
  .primary{background:linear-gradient(90deg,#ff7b95,#ffb3c2);border:none;color:#071026;font-weight:700}
  .small{font-size:13px;color:var(--muted)}
  .result{margin-top:18px;padding:18px;border-radius:12px;background:linear-gradient(180deg, rgba(255,255,255,0.012), rgba(255,255,255,0.006));display:none;white-space:pre-wrap}
  .heart{position:absolute;pointer-events:none}
  @keyframes floatUp{0%{transform:translateY(0) scale(1);opacity:0.95}100%{transform:translateY(-420px) scale(1.25);opacity:0.04}}
  footer{margin-top:14px;color:var(--muted);font-size:13px;text-align:center}
  @media (max-width:720px){ .card{padding:18px} h1{font-size:20px} }
</style>
</head>
<body>
  <div class="card" id="card">
    <audio id="bgm" src="ll.mp3" autoplay loop></audio>
    <header>
      <div>
        <h1>For Stephanie ‚Äî A Deeper Love Quiz</h1>
        <div class="lead">Ten gentle, romantic prompts ‚Äî poetic + thoughtful. Answer from the heart. ‚ù§Ô∏è</div>
      </div>
    </header>

    <div class="intro" id="intro">
      <div id="introText">Hi Stephanie ‚Äî when you're ready, press <strong>Start</strong>. The quiz listens; I will too.</div>
    </div>

    <div class="questions" id="questions"></div>

    <div class="controls">
      <button class="btn primary" id="startBtn">Start</button>
      <button class="btn" id="revealBtn">Reveal All Questions</button>
      <button class="btn" id="finishBtn">Finish & Read My Response</button>
      <button class="btn" id="snapshotBtn">Download Snapshot</button>
      <div style="margin-left:auto" class="small">Music: <button id="musicToggle" class="btn">Play / Pause</button></div>
    </div>

    <div id="result" class="result" role="status" aria-live="polite"></div>

    <footer>Made with all my love ‚Äî Mosope üíñ</footer>
  </div>

  <!-- Soft embedded melody using WebAudio (no external files) -->
<script>
const questionsData = [
  "1) Stephanie ‚Äî When you picture 'love' as a color or a season, what do you see? Describe the image and why it feels like us.",
  "2) My love ‚Äî Name a small ordinary moment with me that, in secret, holds the most meaning for you.",
  "3) Baby ‚Äî If you could whisper one fear about love and have it disappear, what would you whisper to me now?",
  "4) My heart ‚Äî What feeling do you most desire from us in the next year: safety, adventure, closeness, or growth? Why?",
  "5) Stephanie ‚Äî Think of a single word that captures who I am to you. What is it, and what memory makes that word true?",
  "6) My love ‚Äî Is there a rhythm or a ritual you wish we had (a nightly habit, a weekend tradition)? Describe it.",
  "7) Baby ‚Äî When you forgive me, what does that feel like inside you ‚Äî relief, warmth, moving on, or something else?",
  "8) My heart ‚Äî Which part of your future with me feels most bright? Tell me a short scene from it.",
  "9) Stephanie ‚Äî Is there something you've wanted to ask me, but hesitated to? Ask it here ‚Äî I promise to answer with honesty.",
  "10) My love ‚Äî Write one short vow (one sentence) you'd like us to hold as we walk forward together."
];

// Build questions
const qContainer = document.getElementById('questions');
questionsData.forEach((qText, i) => {
  const qEl = document.createElement('div');
  qEl.className = 'q';
  qEl.id = 'q-'+(i+1);
  const label = document.createElement('label');
  label.textContent = qText;
  qEl.appendChild(label);
  const ta = document.createElement('textarea');
  ta.id = 'a-'+(i+1);
  ta.placeholder = 'Write from the heart...';
  qEl.appendChild(ta);
  qContainer.appendChild(qEl);
});

// Visual sequencing: reveal one by one on Start
let revealIndex = 0;
const startBtn = document.getElementById('startBtn');
const revealBtn = document.getElementById('revealBtn');
const finishBtn = document.getElementById('finishBtn');
const resultEl = document.getElementById('result');
const snapshotBtn = document.getElementById('snapshotBtn');
const musicToggle = document.getElementById('musicToggle');
const card = document.getElementById('card');

function revealNext() {
  if (revealIndex >= questionsData.length) return;
  revealIndex++;
  const el = document.getElementById('q-'+revealIndex);
  if (el) el.classList.add('visible');
  // auto-scroll to the new question
  setTimeout(()=>{ el.scrollIntoView({behavior:'smooth', block:'center'}); }, 120);
}

function revealAll() {
  for (let i=1;i<=questionsData.length;i++){
    const el = document.getElementById('q-'+i);
    if (el) el.classList.add('visible');
  }
  document.getElementById('q-1').scrollIntoView({behavior:'smooth'});
  revealIndex = questionsData.length;
}

// typing-like focus: put cursor inside newly revealed textarea
function revealSequence() {
  revealIndex = 0;
  // clear existing visibility
  document.querySelectorAll('.q').forEach(el => el.classList.remove('visible'));
  function next() {
    if (revealIndex >= questionsData.length) return;
    revealNext();
    const ta = document.getElementById('a-'+revealIndex);
    if (ta) {
      setTimeout(()=> ta.focus(), 300);
    }
    // reveal next after a short pause so she can start writing
    revealTimer = setTimeout(next, 900);
  }
  next();
}

// Simple audio: gentle arpeggio loop using WebAudio (will require user interaction in many browsers)


// music toggle button
const bgm = document.getElementById('bgm');
let musicPlaying = false;

function playMusic() {
  bgm.volume = 0.5; // soft volume
  bgm.play().catch(e => console.warn('Autoplay blocked until interaction', e));
  musicPlaying = true;
  musicToggle.textContent = 'Pause';
}

function pauseMusic() {
  bgm.pause();
  musicPlaying = false;
  musicToggle.textContent = 'Play';
}

// Start sequence: reveal one question at a time and try to start music (on user gesture)
musicToggle.addEventListener('click', () => {
  if (musicPlaying) pauseMusic();
  else playMusic();
});
  // attempt to start music (user gesture permits)
  startBtn.addEventListener('click', () => {
  revealSequence();
  if (!musicPlaying) playMusic(); // üé∂ start music when she clicks Start
});

revealBtn.addEventListener('click', () => {
  revealAll();
  if (!musicPlaying) playMusic(); // üé∂ also start when she clicks Reveal All
});

// Finish: collect answers and craft adaptive message
finishBtn.addEventListener('click', () => {
  // gather answers
  const answers = [];
  for (let i=1;i<=questionsData.length;i++){
    answers.push((document.getElementById('a-'+i).value || '').trim());
  }
  // simple analytics: count emotional words and presence of future-safety words
  const textAll = answers.join(' ').toLowerCase();
  const loveWords = ['love','always','forever','together','home','safe','trust','dream','cherish','heart','promise','forever'];
  let score = 0;
  loveWords.forEach(w => { if (textAll.includes(w)) score++; });
  const filled = answers.filter(a => a.length>0).length;

  // pick some highlights to echo back
  function pick(n){
    const picks = answers.filter(a=>a.length>0);
    return picks.slice(0,n).map(p => `"${p}"`).join(' ‚Äî ');
  }
  const highlight = pick(2) || 'your words';

  // build a tailored final message
  let tone = '';
  if (score >= 5 && filled >= 7) tone = "deeply certain and warm";
  else if (score >=3 && filled >=5) tone = "hopeful and tender";
  else if (filled >=3) tone = "gentle and thoughtful";
  else tone = "patient and curious";

  const message = `üíå Dear Stephanie,\n\n` +
    `Thank you for sharing parts of your heart with me. Reading ${highlight} made me smile, and I felt the warmth of your thoughts.\n\n` +
    `What I heard in your answers was a love that is ${tone} ‚Äî a bond I want to hold with care. I promise to protect our safety, to chase our dreams together, and to listen when you whisper your fears.\n\n` +
    `If there is anything you asked but want to hear more about, ask me again ‚Äî I'm here, I will answer honestly, and I will treasure your truth.\n\n` +
    `Always yours,\nMosope ‚ù§Ô∏è`;

  resultEl.style.display = 'block';
  resultEl.textContent = message;
  resultEl.scrollIntoView({behavior:'smooth', block:'center'});

  // add hearts and soft glow
  spawnHearts();
});

// spawn hearts animation
function spawnHearts() {
  // remove old
  document.querySelectorAll('.heart').forEach(h => h.remove());
  const emojis = ['‚ù§Ô∏è','üíñ','üíò','üíï','üíû'];
  for (let i=0;i<18;i++){
    const d = document.createElement('div');
    d.className = 'heart';
    d.textContent = emojis[Math.floor(Math.random()*emojis.length)];
    d.style.left = Math.random()*88 + '%';
    d.style.bottom = '-20px';
    d.style.fontSize = (12 + Math.random()*30) + 'px';
    d.style.opacity = (0.5 + Math.random()*0.5);
    const delay = Math.random()*1.8;
    const dur = 5 + Math.random()*5;
    d.style.animation = `floatUp ${dur}s linear ${delay}s forwards`;
    card.appendChild(d);
  }
}

// snapshot (download PNG)
snapshotBtn.addEventListener('click', () => {
  // build text summary for snapshot
  let text = "For Stephanie ‚Äî A Deeper Love Note from Mosope\\n\\n";
  for (let i=1;i<=questionsData.length;i++){
    const a = document.getElementById('a-'+i).value || '(no answer)';
    text += (i) + '. ' + a + '\\n\\n';
  }
  // create canvas
  const canvas = document.createElement('canvas');
  const pad = 36;
  const w = 1000;
  const lines = text.split('\\n');
  const lh = 26;
  const h = pad*2 + lines.length*lh + 80;
  canvas.width = w; canvas.height = h;
  const ctx = canvas.getContext('2d');
  ctx.fillStyle = '#071026'; ctx.fillRect(0,0,w,h);
  ctx.fillStyle = '#fff'; ctx.font = '700 24px Inter, Arial'; ctx.fillText('For Stephanie ‚Äî A Deeper Love Note', pad, 44);
  ctx.fillStyle = '#f2f6fa'; ctx.font = '18px Inter, Arial';
  let y = 80;
  lines.forEach(line => {
    // wrap if needed
    const maxW = w - pad*2;
    if (ctx.measureText(line).width < maxW) { ctx.fillText(line, pad, y); y += lh; }
    else {
      const words = line.split(' '); let cur='';
      words.forEach(word => {
        const test = cur + word + ' ';
        if (ctx.measureText(test).width > maxW) { ctx.fillText(cur, pad, y); cur = word + ' '; y += lh; }
        else cur = test;
      });
      if (cur.trim() !== '') { ctx.fillText(cur, pad, y); y += lh; }
    }
  });
  ctx.fillStyle = '#ffd1dc'; ctx.font = '600 16px Inter, Arial'; ctx.fillText('- With all my love, Mosope', pad, h-40);
  const link = document.createElement('a'); link.download = 'deeper_love_note_stephanie.png'; link.href = canvas.toDataURL('image/png'); link.click();
});

// ensure all questions are visible on load for accessibility (but hidden visually until reveal)
window.onload = () => {
  // keep them hidden initially
  // revealIndex left at 0 until Start is pressed
};
</script>
</body>
</html>
